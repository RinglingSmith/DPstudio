<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DP Studio</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
        <aside id="sidebar">
        <header>
        <h1>Draw&Paint Studio</h1>
        </header>
        <div id="controls">
            <input type="color" id="colorPicker" value="#000000">
            <p>colorPicker</p>
            <input type="range" id="brushSize" min="1" max="50" value="5">
            <select id="brushType">
                <option value="round">round</option>
                <option value="eraser">Eraser</option>
                <option value="square">square</option>
                <option value="calligraphy">Calligraphy</option>
                <option value="airbrush">Airbrush</option>
                <option value="pixel">Pixel</option>
                <option value="mirrorX">Mirror X</option>
                <option value="patternDot">Pattern Dot</option>
            </select>
            <button id="clearBtn">Clear</button>
            <button id="savePngBtn">Save as PNG</button>
            <button id="saveJpgBtn">Save as JPG</button>
        </div>

           <button id="eraser">Eraser</button>

       <script>
        let activeLayerIndex = null; // Active layer index

        // Function to update the layer list from the backend
        function updateLayerList() {
            fetch('/LayerServlet')
                .then(response => response.json())
                .then(data => {
                    const layers = data.layers;
                    const layerListDiv = document.getElementById('layer-list');
                    layerListDiv.innerHTML = '<h3>Layers</h3>'; // Reset the layer list

                    layers.forEach((layer, index) => {
                        const layerButton = document.createElement('button');
                        layerButton.textContent = layer;
                        layerButton.onclick = () => setActiveLayer(index);
                        layerListDiv.appendChild(layerButton);
                    });
                })
                .catch(error => console.error('Error fetching layers:', error));
        }

        // Function to add a new layer to the backend
        function addLayer() {
            const layerName = prompt("Enter new layer name:");

            if (layerName) {
                fetch('/LayerServlet', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: `layerName=${layerName}`
                })
                .then(response => response.json())
                .then(data => updateLayerList())
                .catch(error => console.error('Error adding layer:', error));
            }
        }

        // Function to remove the active layer
        function removeLayer() {
            if (activeLayerIndex !== null) {
                fetch(`/LayerServlet?index=${activeLayerIndex}`, { method: 'DELETE' })
                    .then(response => response.json())
                    .then(data => updateLayerList())
                    .catch(error => console.error('Error removing layer:', error));
            } else {
                alert('No layer selected!');
            }
        }

        // Function to set the active layer by index
        function setActiveLayer(index) {
            activeLayerIndex = index;
            alert(`Layer ${index + 1} is now active!`);
        }

        // Initial update of the layer list
        updateLayerList();
    </script>

          <div>
            <label for="canvasWidth">Width:</label>
            <input type="number" id="canvasWidth" value="800" min="100">
        </div>
        <div>
            <label for="canvasHeight">Height:</label>
            <input type="number" id="canvasHeight" value="600" min="100">
        </div>
            <button id="resizeCanvasBtn">Resize Canvas</button>

            <button id="keydown">Undo</button>
        </aside>

    <main>
    <div id="canvasWrapper" style="position:relative; width:800px; height:600px; border:1px solid #ccc;">
    <canvas id="paintCanvas" width="800" height="600" style="position:absolute; top:0; left:0; z-index:1;"></canvas>
    </div>
    </main>

    <script src="layer.java"></script>
    <script src="paint.js"></script>
    <script src="canvasHeight.js"></script>
    <script src="zoom.js"></script>
</body>
</html>
